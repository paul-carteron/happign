<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Download a raster layer from the IGN Web Mapping Services (WMS).
Specify a location using a shape and provide the layer name."><title>Download WMS raster layer — get_wms_raster • happign</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Download WMS raster layer — get_wms_raster"><meta property="og:description" content="Download a raster layer from the IGN Web Mapping Services (WMS).
Specify a location using a shape and provide the layer name."><meta property="og:image" content="https://paul-carteron.github.io/happign/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">happign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/web_only/api_carto.html">API Carto</a>
    <a class="dropdown-item" href="../articles/Getting_started.html">Getting started with happign</a>
    <a class="dropdown-item" href="../articles/web_only/happign_for_foresters.html">happign for foresters</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/paul-carteron/happign/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Download WMS raster layer</h1>
      <small class="dont-index">Source: <a href="https://github.com/paul-carteron/happign/blob/HEAD/R/get_wms_raster.R" class="external-link"><code>R/get_wms_raster.R</code></a></small>
      <div class="d-none name"><code>get_wms_raster.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Download a raster layer from the IGN Web Mapping Services (WMS).
Specify a location using a shape and provide the layer name.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_wms_raster</span><span class="op">(</span><span class="va">x</span>,</span>
<span>               layer <span class="op">=</span> <span class="st">"ORTHOIMAGERY.ORTHOPHOTOS"</span>,</span>
<span>               res <span class="op">=</span> <span class="fl">10</span>,</span>
<span>               crs <span class="op">=</span> <span class="fl">2154</span>,</span>
<span>               rgb <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".tif"</span><span class="op">)</span>,</span>
<span>               verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               interactive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Object of class <code>sf</code> or <code>sfc</code>, located in France.</p></dd>


<dt>layer</dt>
<dd><p><code>character</code>; layer name obtained from
<code>get_layers_metadata("wms-r")</code> or the
<a href="https://geoservices.ign.fr/services-web-experts" class="external-link">IGN website</a>.</p></dd>


<dt>res</dt>
<dd><p><code>numeric</code>; resolution specified in the units of
the coordinate system (e.g., meters for EPSG:2154, degrees for EPSG:4326).
See details for more information.</p></dd>


<dt>crs</dt>
<dd><p><code>numeric</code>, <code>character</code>, or object of class <code>sf</code> or <code>sfc</code>;
defaults to EPSG:2154. See <code><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">sf::st_crs()</a></code> for more details.</p></dd>


<dt>rgb</dt>
<dd><p><code>boolean</code>; if set to <code>TRUE</code>, downloads an RGB image. If set
to <code>FALSE</code>, downloads a single band with floating point values.
See details for more information.</p></dd>


<dt>filename</dt>
<dd><p><code>character</code> or <code>NULL</code>; specifies the filename or an
open connection for writing (e.g., "test.tif" or "~/test.tif").
If <code>NULL</code>, uses <code>layer</code> as the filename. The default format is ".tif",
but all <a href="https://gdal.org/drivers/raster/index.html" class="external-link">GDAL drivers</a>
are supported.</p></dd>


<dt>verbose</dt>
<dd><p><code>boolean</code>; if TRUE, message are added.</p></dd>


<dt>overwrite</dt>
<dd><p><code>boolean</code>; if TRUE, the existing raster will be overwritten.</p></dd>


<dt>interactive</dt>
<dd><p><code>logical</code>; if TRUE, an interactive menu prompts for
<code>apikey</code> and <code>layer</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>SpatRaster</code> object from <code>terra</code> package.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    
<ul><li><p><code>res</code>: Note that setting <code>res</code> higher than the default resolution
of the layer will increase the number of pixels but not the precision
of the image. For instance, downloading the BD Alti layer from IGN
is optimal at a resolution of 25m.</p></li>
<li><p><code>rgb</code>: Rasters are commonly used to download images such as orthophotos.
In specific cases like DEMs, however, a value per pixel is essential.</p></li>
<li><p><code>overwrite</code>: The function <code>get_wms_raster</code> first checks if
<code>filename</code> already exists. If it does, the file is imported into
R without downloading again, unless <code>overwrite</code> is set to <code>TRUE</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="get_layers_metadata.html">get_layers_metadata()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-tmap.github.io/tmap/" class="external-link">tmap</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Shape from the best town in France</span></span></span>
<span class="r-in"><span><span class="va">penmarch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/penmarch.shp"</span>, package <span class="op">=</span> <span class="st">"happign"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For quick testing use interactive = TRUE</span></span></span>
<span class="r-in"><span><span class="va">raster</span> <span class="op">&lt;-</span> <span class="fu">get_wms_raster</span><span class="op">(</span>x <span class="op">=</span> <span class="va">penmarch</span>, res <span class="op">=</span> <span class="fl">25</span>, interactive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For specific data, choose apikey with get_apikey() and layer with get_layers_metadata()</span></span></span>
<span class="r-in"><span><span class="va">apikey</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_apikeys.html">get_apikeys</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>  <span class="co"># altimetrie</span></span></span>
<span class="r-in"><span><span class="va">metadata_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_layers_metadata.html">get_layers_metadata</a></span><span class="op">(</span><span class="st">"wms-r"</span>, <span class="va">apikey</span><span class="op">)</span> <span class="co"># all layers for altimetrie wms</span></span></span>
<span class="r-in"><span><span class="va">layer</span> <span class="op">&lt;-</span> <span class="va">metadata_table</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="co"># ELEVATION.ELEVATIONGRIDCOVERAGE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Downloading digital elevation model values not image</span></span></span>
<span class="r-in"><span><span class="va">mnt_2154</span> <span class="op">&lt;-</span> <span class="fu">get_wms_raster</span><span class="op">(</span><span class="va">penmarch</span>, <span class="va">layer</span>, res <span class="op">=</span> <span class="fl">1</span>, crs <span class="op">=</span> <span class="fl">2154</span>, rgb <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If crs is set to 4326, res is in degrees</span></span></span>
<span class="r-in"><span><span class="va">mnt_4326</span> <span class="op">&lt;-</span> <span class="fu">get_wms_raster</span><span class="op">(</span><span class="va">penmarch</span>, <span class="va">layer</span>, res <span class="op">=</span> <span class="fl">0.0001</span>, crs <span class="op">=</span> <span class="fl">4326</span>, rgb <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plotting result</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">mnt_4326</span><span class="op">)</span><span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_raster.html" class="external-link">tm_raster</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">penmarch</span><span class="op">)</span><span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_polygons.html" class="external-link">tm_borders</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"blue"</span>, lwd  <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul Carteron.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

