<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Download a raster layer from IGN Web Mapping Services (WMS).
To do that, it need a location giving by a shape, an apikey
and the name of layer. You can find those information from
IGN website
or with get_apikeys() and get_layers_metadata()."><title>Download WMS raster layer — get_wms_raster • happign</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Download WMS raster layer — get_wms_raster"><meta property="og:description" content="Download a raster layer from IGN Web Mapping Services (WMS).
To do that, it need a location giving by a shape, an apikey
and the name of layer. You can find those information from
IGN website
or with get_apikeys() and get_layers_metadata()."><meta property="og:image" content="https://paul-carteron.github.io/happign/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">happign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Getting_started.html">Getting started with happign</a>
    <a class="dropdown-item" href="../articles/SCAN_25_SCAN_100_SCAN_OACI.html">SCAN 25, SCAN 100 et SCAN OACI</a>
    <a class="dropdown-item" href="../articles/web_only/completion_of_ign_data_road_example.html">Completion of IGN data, road example</a>
    <a class="dropdown-item" href="../articles/web_only/happign_for_foresters.html">happign for foresters</a>
    <a class="dropdown-item" href="../articles/web_only/resolution_for_raster.html">Resolution for raster</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/paul-carteron/happign/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Download WMS raster layer</h1>
      <small class="dont-index">Source: <a href="https://github.com/paul-carteron/happign/blob/HEAD/R/get_wms_raster.R" class="external-link"><code>R/get_wms_raster.R</code></a></small>
      <div class="d-none name"><code>get_wms_raster.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Download a raster layer from IGN Web Mapping Services (WMS).
To do that, it need a location giving by a shape, an apikey
and the name of layer. You can find those information from
<a href="https://geoservices.ign.fr/services-web-experts" class="external-link">IGN website</a>
or with <code><a href="get_apikeys.html">get_apikeys()</a></code> and <code><a href="get_layers_metadata.html">get_layers_metadata()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_wms_raster</span><span class="op">(</span><span class="va">shape</span>,</span>
<span>               apikey <span class="op">=</span> <span class="st">"altimetrie"</span>,</span>
<span>               layer_name <span class="op">=</span> <span class="st">"ELEVATION.ELEVATIONGRIDCOVERAGE.HIGHRES"</span>,</span>
<span>               resolution <span class="op">=</span> <span class="fl">5</span>,</span>
<span>               filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".tif"</span><span class="op">)</span>,</span>
<span>               crs <span class="op">=</span> <span class="fl">2154</span>,</span>
<span>               overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               version <span class="op">=</span> <span class="st">"1.3.0"</span>,</span>
<span>               styles <span class="op">=</span> <span class="st">""</span>,</span>
<span>               interactive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>shape</dt>
<dd><p>Object of class <code>sf</code>. Needs to be located in
France.</p></dd>


<dt>apikey</dt>
<dd><p>API key from <code><a href="get_apikeys.html">get_apikeys()</a></code> or directly
from <a href="https://geoservices.ign.fr/services-web-experts" class="external-link">IGN website</a>.</p></dd>


<dt>layer_name</dt>
<dd><p>Name of the layer from <code>get_layers_metadata(apikey, "wms")</code>
or directly from
<a href="https://geoservices.ign.fr/services-web-experts" class="external-link">IGN website</a>.</p></dd>


<dt>resolution</dt>
<dd><p>Cell size in meter. See detail for more information about resolution.</p></dd>


<dt>filename</dt>
<dd><p>Either a character string naming a file or a connection open
for writing. (ex : "test.tif" or "~/test.tif"). If <code>NULL</code>, layer_name is used.
Default drivers is ".tif" but all gdal drivers are supported, see details
for more info. To avoid re-downloads, <code>get_wms raster</code> checks that there is
not already a raster with that name. If it does, it is imported into R without
further downloading if <code>overwrite</code> is set to FALSE.</p></dd>


<dt>crs</dt>
<dd><p>Numeric, character, or object of class sf or sfc. It is set to EPSG:2154
by default. See <code><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">sf::st_crs()</a></code> for more detail.</p></dd>


<dt>overwrite</dt>
<dd><p>If TRUE, output raster is overwrite.</p></dd>


<dt>version</dt>
<dd><p>The version of the service used. See detail for more
information about <code>version</code>.</p></dd>


<dt>styles</dt>
<dd><p>The rendering style of the layers. Set to "" by default.
See detail for more information about <code>styles</code>.</p></dd>


<dt>interactive</dt>
<dd><p>If set to TRUE, no need to specify <code>apikey</code> and <code>layer_name</code>,
you'll be ask.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>get_wms_raster</code> return an object of class <code>SpatRaster</code> from <code>terra</code> package.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    
<ul><li><p>Raster tile are limited to 2048x2048 pixels so depending of the shape
and the resolution, correct number of tiles to download is calculated.
This mean that setting the <code>resolution</code> argument higher than the base resolution
of the layer multiplies the number of pixels without increasing
the precision. For example, the download of the BD Alti layer from
IGN will be optimal for a resolution of 25m.</p></li>
<li><p><code>version</code> and <code>styles</code> arguments are detailed on
<a href="https://geoservices.ign.fr/documentation/services/api-et-services-ogc/images-wms-ogc" class="external-link">IGN documentation</a></p></li>
<li><p>Using the <code>crs</code> argument avoids post-reprojection which can be time consuming</p></li>
<li><p>All GDAL supported drivers can be found <a href="https://gdal.org/drivers/raster/index.html" class="external-link">here</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="get_apikeys.html">get_apikeys()</a></code>, <code><a href="get_layers_metadata.html">get_layers_metadata()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-tmap/tmap" class="external-link">tmap</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># shape from the best town in France</span></span></span>
<span class="r-in"><span><span class="va">penmarch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/penmarch.shp"</span>, package <span class="op">=</span> <span class="st">"happign"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For quick testing, use interactive = TRUE</span></span></span>
<span class="r-in"><span><span class="va">raster</span> <span class="op">&lt;-</span> <span class="fu">get_wms_raster</span><span class="op">(</span>shape <span class="op">=</span> <span class="va">penmarch</span>, interactive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For specific use, choose apikey with get_apikey() and layer_name with get_layers_metadata()</span></span></span>
<span class="r-in"><span><span class="va">apikey</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_apikeys.html">get_apikeys</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>  <span class="co"># altimetrie</span></span></span>
<span class="r-in"><span><span class="va">metadata_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_layers_metadata.html">get_layers_metadata</a></span><span class="op">(</span><span class="va">apikey</span>, <span class="st">"wms"</span><span class="op">)</span> <span class="co"># all layers for altimetrie wms</span></span></span>
<span class="r-in"><span><span class="va">layer_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">metadata_table</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># ELEVATION.ELEVATIONGRIDCOVERAGE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Downloading digital elevation model from IGN</span></span></span>
<span class="r-in"><span><span class="va">mnt</span> <span class="op">&lt;-</span> <span class="fu">get_wms_raster</span><span class="op">(</span><span class="va">penmarch</span>, <span class="va">apikey</span>, <span class="va">layer_name</span>, resolution <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Preparing raster for plotting</span></span></span>
<span class="r-in"><span><span class="va">mnt</span><span class="op">[</span><span class="va">mnt</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span> <span class="co"># remove negative values in case of singularity</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mnt</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Elevation [m]"</span> <span class="co"># Rename raster ie the title legend</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plotting result</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">mnt</span><span class="op">)</span><span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html" class="external-link">tm_raster</a></span><span class="op">(</span>legend.show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">penmarch</span><span class="op">)</span><span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html" class="external-link">tm_borders</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"blue"</span>, lwd  <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Paul Carteron.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

